# 🎵 MP3 Microservices System

This is a **Java Spring Boot** project composed of two microservices: `resourceservice` and `songservice`.  
The system allows uploading MP3 files, automatically extracting their metadata (**title, artist, album, duration, year**), and storing that data separately in another microservice.

---

## 🧱 Project Structure

```
git-microservices/
├── resourceservice/     # Stores MP3 files & extracts metadata
├── songservice/         # Stores extracted song metadata
├── compose.yaml          # Docker Compose for PostgreSQL containers
└── .gitignore
```

---

## ⚙️ Technologies Used

| Technology         | Purpose                                           |
|-------------------|---------------------------------------------------|
| Java 17           | Primary programming language                      |
| Spring Boot 3.4.5 | Framework for building RESTful microservices      |
| Apache Tika       | Extracts metadata from MP3 files                  |
| PostgreSQL 16     | Database engine for both services                 |
| Spring Data JPA   | ORM for DB interaction                            |
| Hibernate         | Auto-generates DB schema via `ddl-auto=update`    |
| Docker Compose    | Runs both PostgreSQL DBs in isolated containers   |
| Bean Validation   | Ensures input data integrity using annotations    |

---

## 🧩 How It Works

### 🔊 `resourceservice`

- Accepts and stores uploaded MP3 files.
- Uses Apache Tika to extract metadata.
- Converts duration from seconds to `mm:ss`.
- Sends the extracted metadata to `songservice` via HTTP.

### 🎼 `songservice`

- Receives metadata from `resourceservice`.
- Validates and stores it in its own PostgreSQL database.

> Each MP3 resource has a **one-to-one** relationship with its corresponding metadata.

---

## 🚀 Getting Started

### 1. Clone the repository

```bash
git clone https://github.com/Yura009/git-microservices.git
cd git-microservices
```

### 2. Start PostgreSQL containers

```bash
docker compose up -d
```

### 3. Run both microservices

In two separate terminals:

```bash
# Terminal 1
cd resourceservice
./mvnw spring-boot:run
```

```bash
# Terminal 2
cd songservice
./mvnw spring-boot:run
```

---

## 📬 API Overview

### 🔊 `resourceservice` Endpoints

#### 📤 Upload MP3 File

```http
POST /resources
Content-Type: audio/mpeg
Body: binary MP3 file

Response:
200 OK
{
  "id": 1
}
```

#### 📥 Get MP3 File by ID

```http
GET /resources/{id}

Response:
200 OK
Content-Type: audio/mpeg
Body: binary MP3 file
```

#### 🗑️ Delete MP3 Files

```http
DELETE /resources?id=1,2

Response:
200 OK
{
  "ids": [1, 2]
}
```

---

### 🎼 `songservice` Endpoints

#### 📝 Create Song Metadata

```http
POST /songs
Content-Type: application/json

Body:
{
  "id": 1,
  "name": "We are the champions",
  "artist": "Queen",
  "album": "News of the world",
  "duration": "02:59",
  "year": "1977"
}

Response:
200 OK
{
  "id": 1
}
```

#### 📄 Get Song Metadata

```http
GET /songs/{id}

Response:
200 OK
{
  "id": 1,
  "name": "We are the champions",
  "artist": "Queen",
  "album": "News of the world",
  "duration": "02:59",
  "year": "1977"
}
```

#### 🗑️ Delete Song Metadata

```http
DELETE /songs?id=1,2

Response:
200 OK
{
  "ids": [1, 2]
}
```

---

## ✅ Notes

- No Flyway or SQL scripts are used — schema is generated by Hibernate.
- All communication is **synchronous HTTP** via Feign Client or RestTemplate.
- Controllers are thin; business logic is in service layer.
- Global exception handling and request validation are included.
- Duration is sent in `mm:ss` format, all other metadata is preserved as-is.

---

> Feel free to fork, clone, and contribute to this project!
